{"mappings":"oeAEA,IAAAA,EAAAC,EAAA,S,uCAMA,MAAMC,EAAiBC,SAASC,cAAc,kBAkBxCC,GAAc,EAAAC,EAAAC,eAAcC,EAAAC,gBAC5BC,GAAK,EAAAC,EAAAC,aAAYP,GACjBQ,GAAO,EAAAb,EAAAc,SAAQT,GAsCrBH,GAAgBa,iBAAiB,SAASC,MAAOC,IAC/CA,EAAMC,iBAMNC,GAAA,IAIF,MAAMA,EAAc,KAClB,MAAMC,EAAWjB,SAASC,cAAc,eACxC,EAAAJ,EAAAqB,oBAAmBR,GAAMG,MAAOM,IAC9B,GAAIA,EAAM,CACR,MAAMC,GAAc,EAAAZ,EAAAa,KAAId,EAAI,SAEtBe,SADyB,EAAAd,EAAAe,KAAIH,IACJI,MAC/BC,QAAQC,IAAIJ,GAEZ,MAAMK,EAAMR,EAAKQ,IACXC,GAAU,EAAApB,EAAAa,KAAId,EAAI,UAClBsB,GAAS,EAAArB,EAAAsB,MAAMF,IAExB,EAAApB,EAAAuB,KAAIF,EAAQ,CACXG,OAASL,EACTM,QAAUhB,EAASiB,OAInB,IACF,EASFC,OAAOvB,iBAAiB,QAnEX,MAET,EAAAf,EAAAqB,oBAAmBR,GAAOS,IAEtB,GADAM,QAAQC,IAAI,qBAAsBP,GAC9BA,EAAM,CACR,MAAMa,EAASb,EAAKQ,IACdS,GAAK,EAAA5B,EAAAC,eACLmB,GAAU,EAAApB,EAAAa,KAAIe,EAAI,SAASJ,MAEjC,EAAAxB,EAAA6B,SAAQT,GAAUU,IAChB,MAAMC,EAAWD,EAASd,MAC1BC,QAAQC,IAAI,WAAYa,GACxBd,QAAQC,IAAIa,EAASC,gBACrBf,QAAQC,IAAIa,EAASE,UACrB,MAAMA,EAAWzC,SAASC,cAAc,aAClCyC,EAAM1C,SAASC,cAAc,QACnCwC,EAASE,UAAYJ,EAASE,SAC9BC,EAAIE,IAAML,EAASC,cAAc,GAKrC,IAEJ,IAiDJ,MAAMK,GAAU,EAAArC,EAAAa,KAAId,EAAI,WACxB,EAAAC,EAAA6B,SAAQQ,GAAUP,IAChB,MAAMQ,EAAQR,EAASd,MAEjBuB,EAAc/C,SAASC,cAAc,UAC3C8C,EAAYJ,UAAY,GAExB,IAAK,MAAMK,KAAUF,EAAO,CAC1B,MAAMxB,EAAQgB,EAASd,MACvBC,QAAQC,IAAIJ,GACZ,MACMW,EADOa,EAAME,GACEf,QAEfgB,EAAcjD,SAASkD,cAAc,OAC3CD,EAAYE,YAAclB,EAC1Bc,EAAYK,YAAYH,EAC1B","sources":["src/modules/mainpage.ts"],"sourcesContent":["//mainpage\r\n\r\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\r\nimport { getDatabase, ref, onValue, set, push , get} from 'firebase/database';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { firebaseConfig } from './firebase'; \r\n\r\n\r\nconst myUpdateButton = document.querySelector('#my-update-btn');\r\n// const outputDiv = document.querySelector('#output'); \r\n\r\n// function getTextFromInputElement(input: HTMLInputElement): string {\r\n//   return input.value;\r\n// }\r\n\r\n\r\n// myUpdateButton?.addEventListener('click', () => {\r\n//   const text = getTextFromInputElement(myUpdate);\r\n\r\n//   const p = document.createElement('p');\r\n//   p.textContent = text;\r\n//   if (outputDiv) {\r\n//     outputDiv.appendChild(p);\r\n//   }\r\n\r\n// });\r\nconst firebaseApp = initializeApp(firebaseConfig);\r\nconst db = getDatabase(firebaseApp);\r\nconst auth = getAuth(firebaseApp);\r\n\r\ninterface UserData {\r\n  name: string;\r\n  profilePicture: string;\r\n}\r\n\r\ninterface Post {\r\n  content: string;\r\n}\r\n\r\nconst main = () => {\r\n\r\n    onAuthStateChanged(auth, (user) => {\r\n        console.log('auth state changed', user);\r\n        if (user) {\r\n          const userId = user.uid;\r\n          const db = getDatabase();\r\n          const userRef = ref(db, `users/${userId}`);\r\n\r\n          onValue(userRef, (snapshot) =>{\r\n            const userData = snapshot.val();\r\n            console.log('userData', userData);\r\n            console.log(userData.profilePicture);\r\n            console.log(userData.username);\r\n            const username = document.querySelector('#username') as HTMLElement\r\n            const pic = document.querySelector('#pic') as HTMLImageElement\r\n            username.innerHTML = userData.username\r\n            pic.src = userData.profilePicture\r\n\r\n          })\r\n          \r\n          \r\n        }\r\n        \r\n    })\r\n}\r\n//knappfunktion\r\nmyUpdateButton?.addEventListener('click', async (event) => {\r\n  event.preventDefault();\r\n\r\n  // const post: Post = {\r\n  //   content: myUpdate.value\r\n  // };\r\n\r\n  createPost()\r\n})\r\n//Skapa inlägg\r\n\r\nconst createPost =  () => {\r\n  const myUpdate = document.querySelector('#my-update') as HTMLInputElement\r\n  onAuthStateChanged(auth, async (user)  => {\r\n    if (user) {\r\n      const productsRef = ref(db, 'users');\r\n      const productsSnapshot = await get(productsRef);\r\n      const users = productsSnapshot.val();\r\n      console.log(users)\r\n\r\n      const uid = user.uid\r\n      const userRef = ref(db, `posts/`);\r\n      const newPost= push (userRef)\r\n      // push(userRef, content);\r\n   set(newPost,{\r\n    userId : uid, \r\n    content : myUpdate.value,\r\n    \r\n   \r\n   })\r\n    }\r\n  });\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nwindow.addEventListener('load', main);\r\n\r\n//visa inlägg\r\n\r\n\r\n\r\nconst postRef = ref(db, `posts/`);\r\nonValue(postRef, (snapshot) => {\r\n  const posts = snapshot.val();\r\n\r\n  const postContent = document.querySelector('.posts') as HTMLElement\r\n  postContent.innerHTML = '';\r\n  \r\n  for (const postId in posts) {\r\n    const users = snapshot.val()\r\n    console.log(users)\r\n    const post = posts[postId];\r\n    const content = post.content;\r\n    // display the content on your page\r\n    const postElement = document.createElement('div');\r\n    postElement.textContent = content;\r\n    postContent.appendChild(postElement);\r\n  }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["$6AR8M","parcelRequire","$26e40e4babb8c21b$var$myUpdateButton","document","querySelector","$26e40e4babb8c21b$var$firebaseApp","$fhN3L","initializeApp","$k8Jq9","firebaseConfig","$26e40e4babb8c21b$var$db","$gdelx","getDatabase","$26e40e4babb8c21b$var$auth","getAuth","addEventListener","async","event","preventDefault","$26e40e4babb8c21b$var$createPost","myUpdate","onAuthStateChanged","user","productsRef","ref","users","get","val","console","log","uid","userRef","newPost","push","set","userId","content","value","window","db","onValue","snapshot","userData","profilePicture","username","pic","innerHTML","src","$26e40e4babb8c21b$var$postRef","posts","postContent","postId","postElement","createElement","textContent","appendChild"],"version":3,"file":"mainpage.4ac4cf2b.js.map"}